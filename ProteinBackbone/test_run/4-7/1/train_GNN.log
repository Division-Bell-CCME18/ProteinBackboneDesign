Let's use 1 GPUs!
Using device cuda:0 as main device
{'train': {'batch_size': 16, 'seed': 2022, 'epochs': 100, 'shuffle': True, 'resume_train': False, 'eval': True, 'num_workers': 0, 'gpus': [0], 'anneal_power': 2.0, 'save': True, 'save_path': 'D:\\ProteinBackboneDesign\\ProteinBackbone\\test_run\\Run1\\train\\pdb_default', 'resume_checkpoint': None, 'resume_epoch': None, 'log_interval': 400, 'optimizer': {'type': 'Adam', 'lr': 0.001, 'weight_decay': 0.0, 'dropout': 0.0}, 'scheduler': {'type': 'plateau', 'factor': 0.4, 'patience': 10, 'min_lr': '1e-4'}, 'device': device(type='cuda', index=0)}, 'test': {'init_checkpoint': 'D:\\ProteinBackboneDesign\\ProteinBackbone\\test_run\\Run1\\train\\pdb_default', 'output_path': 'D:\\ProteinBackboneDesign\\ProteinBackbone\\test_run\\Run1\\test', 'epoch': 50, 'gen': {'dg_step_size': 3.0, 'dg_num_steps': 1000, 'steps_d': 100, 'step_lr_d': 2e-06, 'steps_pos': 100, 'step_lr_pos': 2.4e-06, 'clip': 1000, 'min_sigma': 0.0, 'verbose': 1}}, 'data': {'base_path': 'D:\\ProteinBackboneDesign\\ProteinBackbone\\pdb_dataset\\debug', 'dataset': 'pdb', 'train_set': 'pdb_dataset_train.pkl', 'val_set': 'pdb_dataset_val.pkl', 'test_set': 'pdb_dataset_test.pkl'}, 'model': {'name': 'pdb_default', 'hidden_dim': 256, 'num_convs': 4, 'sigma_begin': 0.01, 'sigma_end': 0.001, 'num_noise_level': 50, 'order': 3, 'mlp_act': 'relu', 'gnn_act': 'relu', 'cutoff': 10.0, 'short_cut': True, 'concat_hidden': False, 'noise_type': 'symmetry', 'edge_encoder': 'mlp'}}
set seed for random, numpy and torch
loading data from D:\ProteinBackboneDesign\ProteinBackbone\pdb_dataset\debug
train size : 341  ||  val size: 14  ||  test size: 0 
loading data done!
start training...
Epoch: 0 | Step: 1 | loss: 16124415632559279464912733077504.00000 | Lr: 0.00100
Epoch: 0 | Step: 2 | loss: 28988548904386560.00000 | Lr: 0.00100
Epoch: 0 | Step: 3 | loss: 838198395783872512.00000 | Lr: 0.00100
Epoch: 0 | Step: 4 | loss: 93225323176394752.00000 | Lr: 0.00100
Epoch: 0 | Step: 5 | loss: 20830113234944.00000 | Lr: 0.00100
Epoch: 0 | Step: 6 | loss: 423260265287516160.00000 | Lr: 0.00100
Epoch: 0 | Step: 7 | loss: 3695616689438720.00000 | Lr: 0.00100
Epoch: 0 | Step: 8 | loss: 123877439616057344.00000 | Lr: 0.00100
Epoch: 0 | Step: 9 | loss: 17654496356204544.00000 | Lr: 0.00100
Epoch: 0 | Step: 10 | loss: 8584965314838528.00000 | Lr: 0.00100
Epoch: 0 | Train Loss: 732927983298227943552007012352.00000 | Time: 0.79288
Evaluate val Loss: 12442781175775232.00000 | Time: 0.01000
Epoch: 1 | Train Loss: 14107601065384681957947867136.00000 | Time: 0.58500
Evaluate val Loss: 651387490795520.00000 | Time: 0.01000
Epoch: 2 | Train Loss: 38300270819324383467684233216.00000 | Time: 0.57209
Evaluate val Loss: 3186244037115904.00000 | Time: 0.01000
Epoch: 3 | Train Loss: 11942288706467757455837233152.00000 | Time: 0.56981
Evaluate val Loss: 5607335892353024.00000 | Time: 0.01403
Epoch: 4 | Train Loss: 11892481477866063176629485568.00000 | Time: 0.56751
Evaluate val Loss: 1486380672745472.00000 | Time: 0.00900
Epoch: 5 | Train Loss: 11928712332134321469266067456.00000 | Time: 0.59372
Evaluate val Loss: 736272620453888.00000 | Time: 0.01100
Epoch: 6 | Train Loss: 11936644190601322304064454656.00000 | Time: 0.55060
Evaluate val Loss: 866611992985600.00000 | Time: 0.00997
Epoch: 7 | Train Loss: 11957833878315984307370328064.00000 | Time: 0.55015
Evaluate val Loss: 680111762309120.00000 | Time: 0.01000
Epoch: 8 | Train Loss: 11947794985785483839412371456.00000 | Time: 0.56861
Evaluate val Loss: 623254649700352.00000 | Time: 0.01000
Epoch: 9 | Train Loss: 11974857580180672686808104960.00000 | Time: 0.61125
Evaluate val Loss: 454501425217536.00000 | Time: 0.01399
Epoch: 10 | Train Loss: 12051613207769059711416008704.00000 | Time: 0.57261
Evaluate val Loss: 125484549537792.00000 | Time: 0.01000
Epoch: 11 | Train Loss: 12006095605158844877827473408.00000 | Time: 0.55330
Evaluate val Loss: 632747265622016.00000 | Time: 0.01000
Epoch: 12 | Train Loss: 12050429181699985524675051520.00000 | Time: 0.59416
Evaluate val Loss: 235931848146944.00000 | Time: 0.00997
Epoch: 13 | Train Loss: 12067366163743821454966259712.00000 | Time: 0.57539
Evaluate val Loss: 467055883059200.00000 | Time: 0.01000
Epoch: 14 | Train Loss: 12071475481195998444068536320.00000 | Time: 0.65515
Evaluate val Loss: 220064947109888.00000 | Time: 0.01400
Epoch: 15 | Train Loss: 12054999573843311948359270400.00000 | Time: 0.91921
Evaluate val Loss: 98192272130048.00000 | Time: 0.01200
Epoch: 16 | Train Loss: 11826178593833993781783822336.00000 | Time: 0.59256
Evaluate val Loss: 165092150738944.00000 | Time: 0.01000
Epoch: 17 | Train Loss: 11977076233815525629129392128.00000 | Time: 0.60462
Evaluate val Loss: 357665951711232.00000 | Time: 0.01000
Epoch: 18 | Train Loss: 12017323675430888724985020416.00000 | Time: 0.55573
Evaluate val Loss: 145419355029504.00000 | Time: 0.01000
Epoch: 19 | Train Loss: 11973669261051156928816742400.00000 | Time: 0.60335
Evaluate val Loss: 105245875109888.00000 | Time: 0.00997
Epoch: 20 | Train Loss: 12036845079858984843462311936.00000 | Time: 0.62625
Evaluate val Loss: 77573576982528.00000 | Time: 0.01197
Epoch: 21 | Train Loss: 12059409405526223003129479168.00000 | Time: 0.61638
Evaluate val Loss: 132737943994368.00000 | Time: 0.01000
Epoch: 22 | Train Loss: 11972295481710698553617154048.00000 | Time: 0.53654
Evaluate val Loss: 33702201524224.00000 | Time: 0.01000
Epoch: 23 | Train Loss: 12025660798803428310482157568.00000 | Time: 0.57158
Evaluate val Loss: 138994947981312.00000 | Time: 0.01100
Epoch: 24 | Train Loss: 11971855872322515638310404096.00000 | Time: 0.57903
Evaluate val Loss: 132383592415232.00000 | Time: 0.00997
Epoch: 25 | Train Loss: 12114005113741223846165348352.00000 | Time: 0.55107
Evaluate val Loss: 501003807883264.00000 | Time: 0.01000
Epoch: 26 | Train Loss: 12126649035345806296562532352.00000 | Time: 0.54857
Evaluate val Loss: 378606702297088.00000 | Time: 0.01000
Epoch: 27 | Train Loss: 13165408242504441161872048128.00000 | Time: 0.56125
Evaluate val Loss: 30640164569088.00000 | Time: 0.01000
Epoch: 28 | Train Loss: 13307895777085999280231022592.00000 | Time: 0.57015
Evaluate val Loss: 61319126450176.00000 | Time: 0.01000
Epoch: 29 | Train Loss: 13042800153591544080702111744.00000 | Time: 0.57566
Evaluate val Loss: 57062960660480.00000 | Time: 0.00900
Epoch: 30 | Train Loss: 13302709760075723613973512192.00000 | Time: 0.55829
Evaluate val Loss: 47008811319296.00000 | Time: 0.01003
Epoch: 31 | Train Loss: 13333090890190248125793304576.00000 | Time: 0.59954
Evaluate val Loss: 29876004323328.00000 | Time: 0.01000
Epoch: 32 | Train Loss: 13261397639471492962807971840.00000 | Time: 0.55318
Evaluate val Loss: 24813227737088.00000 | Time: 0.00997
Epoch: 33 | Train Loss: 13302378335809833544949170176.00000 | Time: 0.55756
Evaluate val Loss: 36668094545920.00000 | Time: 0.00900
Epoch: 34 | Train Loss: 13284804263596853709972176896.00000 | Time: 0.55222
Evaluate val Loss: 33582810660864.00000 | Time: 0.01000
Epoch: 35 | Train Loss: 13307494805241003255852433408.00000 | Time: 0.58126
Evaluate val Loss: 39066573733888.00000 | Time: 0.01000
Epoch: 36 | Train Loss: 13282146000573045995181441024.00000 | Time: 0.54653
Evaluate val Loss: 36913192894464.00000 | Time: 0.00997
Epoch: 37 | Train Loss: 13330984714738883865981485056.00000 | Time: 0.55018
Evaluate val Loss: 39470569095168.00000 | Time: 0.01003
Epoch: 38 | Train Loss: 13336993282129272442412072960.00000 | Time: 0.55697
Evaluate val Loss: 33104704045056.00000 | Time: 0.01000
Epoch: 39 | Train Loss: 13306130470633501823850250240.00000 | Time: 0.56663
Evaluate val Loss: 35180899205120.00000 | Time: 0.01000
Epoch: 40 | Train Loss: 13330605208196080304692133888.00000 | Time: 0.61598
Evaluate val Loss: 29889161854976.00000 | Time: 0.01000
Epoch: 41 | Train Loss: 13263788015523911998122229760.00000 | Time: 0.56366
Evaluate val Loss: 36772893425664.00000 | Time: 0.01096
Epoch: 42 | Train Loss: 13129349969265407147529732096.00000 | Time: 0.56532
Evaluate val Loss: 36129319419904.00000 | Time: 0.01000
Epoch: 43 | Train Loss: 13325529093533041132528730112.00000 | Time: 0.55645
Evaluate val Loss: 45652767670272.00000 | Time: 0.01000
Epoch: 44 | Train Loss: 13259255402312448531599720448.00000 | Time: 0.55598
Evaluate val Loss: 37206106308608.00000 | Time: 0.01000
Epoch: 45 | Train Loss: 13282832031631196984038129664.00000 | Time: 0.58204
Evaluate val Loss: 39309822394368.00000 | Time: 0.00999
Epoch: 46 | Train Loss: 13292659705588151586773794816.00000 | Time: 0.58520
Evaluate val Loss: 35336486912000.00000 | Time: 0.00997
Epoch: 47 | Train Loss: 13325945520395616258097152000.00000 | Time: 0.57363
Evaluate val Loss: 34933798076416.00000 | Time: 0.01400
Epoch: 48 | Train Loss: 13257442013583024388814405632.00000 | Time: 0.56922
Evaluate val Loss: 26805597634560.00000 | Time: 0.01000
Epoch: 49 | Train Loss: 13331702514444282251077222400.00000 | Time: 0.56578
Evaluate val Loss: 29489790713856.00000 | Time: 0.01000
Epoch: 50 | Train Loss: 13266168088231278299309932544.00000 | Time: 0.54706
Evaluate val Loss: 29693694705664.00000 | Time: 0.01003
Epoch: 51 | Train Loss: 13318807019497695742252810240.00000 | Time: 0.54971
Evaluate val Loss: 28701127344128.00000 | Time: 0.00903
Epoch: 52 | Train Loss: 13152908567730313315246669824.00000 | Time: 0.59282
Evaluate val Loss: 29850932871168.00000 | Time: 0.00904
Epoch: 53 | Train Loss: 13314272689062029698755723264.00000 | Time: 0.59424
Evaluate val Loss: 28852973731840.00000 | Time: 0.00900
Epoch: 54 | Train Loss: 13330704807198261865636429824.00000 | Time: 0.59057
Evaluate val Loss: 28396234997760.00000 | Time: 0.00900
Epoch: 55 | Train Loss: 13331951511949717461740290048.00000 | Time: 0.57363
Evaluate val Loss: 28791451680768.00000 | Time: 0.01000
Epoch: 56 | Train Loss: 13330554550082901429872230400.00000 | Time: 0.55023
Evaluate val Loss: 27536153116672.00000 | Time: 0.01000
Epoch: 57 | Train Loss: 13299580977627800725310406656.00000 | Time: 0.54657
Evaluate val Loss: 27577336987648.00000 | Time: 0.01000
Epoch: 58 | Train Loss: 13331840750990411564996100096.00000 | Time: 0.55740
Evaluate val Loss: 26631695499264.00000 | Time: 0.01100
Epoch: 59 | Train Loss: 13123559489345319768638357504.00000 | Time: 0.58225
Evaluate val Loss: 26636474908672.00000 | Time: 0.01002
Epoch: 60 | Train Loss: 13060254020112228090388676608.00000 | Time: 0.55663
Evaluate val Loss: 30644866383872.00000 | Time: 0.01000
Epoch: 61 | Train Loss: 13242886821470706759150600192.00000 | Time: 0.54968
Evaluate val Loss: 31137640480768.00000 | Time: 0.00900
Epoch: 62 | Train Loss: 13258216481686212811606196224.00000 | Time: 0.56759
Evaluate val Loss: 28273276878848.00000 | Time: 0.01100
Epoch: 63 | Train Loss: 13312127017454654880389005312.00000 | Time: 0.55273
Evaluate val Loss: 27171257057280.00000 | Time: 0.01000
Epoch: 64 | Train Loss: 13315276406592683237305221120.00000 | Time: 0.55100
Evaluate val Loss: 27909058199552.00000 | Time: 0.01000
Epoch: 65 | Train Loss: 13251180155626739239261044736.00000 | Time: 0.57163
Evaluate val Loss: 27056786112512.00000 | Time: 0.00997
Epoch: 66 | Train Loss: 13198155707532900475082899456.00000 | Time: 0.57803
Evaluate val Loss: 28094383521792.00000 | Time: 0.00900
Epoch: 67 | Train Loss: 13268266536173848610480324608.00000 | Time: 0.55687
Evaluate val Loss: 28101488672768.00000 | Time: 0.01000
Epoch: 68 | Train Loss: 13064792643608311515880357888.00000 | Time: 0.57000
Evaluate val Loss: 27944539914240.00000 | Time: 0.01000
Epoch: 69 | Train Loss: 13309734924178057457355980800.00000 | Time: 0.55400
Evaluate val Loss: 27835351695360.00000 | Time: 0.01000
Epoch: 70 | Train Loss: 13209350291933564717770997760.00000 | Time: 0.55575
Evaluate val Loss: 27589422874624.00000 | Time: 0.00900
Epoch: 71 | Train Loss: 13224356255391950460587868160.00000 | Time: 0.54600
Evaluate val Loss: 27945699639296.00000 | Time: 0.01000
Epoch: 72 | Train Loss: 13269174089150646577197481984.00000 | Time: 0.54734
Evaluate val Loss: 27936876920832.00000 | Time: 0.01000
Epoch: 73 | Train Loss: 42586592870628346644649738240.00000 | Time: 0.58100
Evaluate val Loss: 27992162041856.00000 | Time: 0.00900
Epoch: 74 | Train Loss: 13273884435064289498612367360.00000 | Time: 0.54900
Evaluate val Loss: 27891163201536.00000 | Time: 0.01000
Epoch: 75 | Train Loss: 13320174788553551750669271040.00000 | Time: 0.58156
Evaluate val Loss: 27688957902848.00000 | Time: 0.01200
Epoch: 76 | Train Loss: 13166220489539474949639503872.00000 | Time: 0.57896
Evaluate val Loss: 28276430995456.00000 | Time: 0.01000
Epoch: 77 | Train Loss: 42595213335989805632301563904.00000 | Time: 0.54520
Evaluate val Loss: 28012139511808.00000 | Time: 0.01000
Epoch: 78 | Train Loss: 13276261931935392616268431360.00000 | Time: 0.54597
Evaluate val Loss: 28387676520448.00000 | Time: 0.01000
Epoch: 79 | Train Loss: 13316065471101365965473972224.00000 | Time: 0.54740
Evaluate val Loss: 28394261577728.00000 | Time: 0.01200
Epoch: 80 | Train Loss: 13248819830997391411490324480.00000 | Time: 0.57553
Evaluate val Loss: 28352121405440.00000 | Time: 0.00996
Epoch: 81 | Train Loss: 13318539991138391858589204480.00000 | Time: 0.55859
Evaluate val Loss: 28086246572032.00000 | Time: 0.01003
Epoch: 82 | Train Loss: 13300410396904611793195761664.00000 | Time: 0.57556
Evaluate val Loss: 28217595396096.00000 | Time: 0.01000
Epoch: 83 | Train Loss: 13319401179062454720760119296.00000 | Time: 0.55748
Evaluate val Loss: 27984085909504.00000 | Time: 0.01100
Epoch: 84 | Train Loss: 13121264419234645121064501248.00000 | Time: 0.55941
Evaluate val Loss: 27931854241792.00000 | Time: 0.01000
Epoch: 85 | Train Loss: 13212480791605665994152869888.00000 | Time: 0.55568
Evaluate val Loss: 27936501530624.00000 | Time: 0.01100
Epoch: 86 | Train Loss: 13287818850637080941104726016.00000 | Time: 0.56319
Evaluate val Loss: 27911927103488.00000 | Time: 0.00900
Epoch: 87 | Train Loss: 13135241765411852276060913664.00000 | Time: 0.56955
Evaluate val Loss: 27514160283648.00000 | Time: 0.01000
Epoch: 88 | Train Loss: 13159166132626154694526369792.00000 | Time: 0.55655
Evaluate val Loss: 27906508062720.00000 | Time: 0.00999
Epoch: 89 | Train Loss: 13291683463644268688840851456.00000 | Time: 0.56270
Evaluate val Loss: 27957621948416.00000 | Time: 0.00900
Epoch: 90 | Train Loss: 13259068224877305536440172544.00000 | Time: 0.57359
Evaluate val Loss: 27931204124672.00000 | Time: 0.01000
Epoch: 91 | Train Loss: 13309361427919867257966034944.00000 | Time: 0.56427
Evaluate val Loss: 28037359861760.00000 | Time: 0.01297
Epoch: 92 | Train Loss: 13257695304148925359983689728.00000 | Time: 0.57000
Evaluate val Loss: 28017906679808.00000 | Time: 0.01000
Epoch: 93 | Train Loss: 13261971192346139875992403968.00000 | Time: 0.57929
Evaluate val Loss: 27966761336832.00000 | Time: 0.00900
Epoch: 94 | Train Loss: 13230409470610902350915698688.00000 | Time: 0.61278
Evaluate val Loss: 27896750014464.00000 | Time: 0.01000
Epoch: 95 | Train Loss: 13320054582861262522448609280.00000 | Time: 0.57239
Evaluate val Loss: 27897469337600.00000 | Time: 0.00900
Epoch: 96 | Train Loss: 13193228991373136942870822912.00000 | Time: 0.57108
Evaluate val Loss: 27831039950848.00000 | Time: 0.01000
Epoch: 97 | Train Loss: 13318673076011999203491315712.00000 | Time: 0.57100
Evaluate val Loss: 27873547124736.00000 | Time: 0.01000
Epoch: 98 | Train Loss: 13285564993906637021246390272.00000 | Time: 0.59466
Evaluate val Loss: 27796631977984.00000 | Time: 0.00997
Epoch: 99 | Train Loss: 13311547454295394605305167872.00000 | Time: 0.54928
Evaluate val Loss: 27832503762944.00000 | Time: 0.01003
optimization finished.
Total time elapsed: 58.58610s
