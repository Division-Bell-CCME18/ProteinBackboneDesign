Let's use 1 GPUs!
Using device cuda:0 as main device
{'train': {'batch_size': 16, 'seed': 2022, 'epochs': 100, 'shuffle': True, 'resume_train': False, 'eval': True, 'num_workers': 0, 'gpus': [0], 'anneal_power': 2.0, 'save': True, 'save_path': 'D:\\ProteinBackboneDesign\\ProteinBackbone\\test_run\\Run1\\train\\pdb_default', 'resume_checkpoint': None, 'resume_epoch': None, 'log_interval': 400, 'optimizer': {'type': 'Adam', 'lr': 0.001, 'weight_decay': 0.0, 'dropout': 0.0}, 'scheduler': {'type': 'plateau', 'factor': 0.6, 'patience': 10, 'min_lr': '1e-4'}, 'device': device(type='cuda', index=0)}, 'test': {'init_checkpoint': 'D:\\ProteinBackboneDesign\\ProteinBackbone\\test_run\\Run1\\train\\pdb_default', 'output_path': 'D:\\ProteinBackboneDesign\\ProteinBackbone\\test_run\\Run1\\test', 'epoch': 50, 'gen': {'dg_step_size': 3.0, 'dg_num_steps': 1000, 'steps_d': 100, 'step_lr_d': 2e-06, 'steps_pos': 100, 'step_lr_pos': 2.4e-06, 'clip': 1000, 'min_sigma': 0.0, 'verbose': 1}}, 'data': {'base_path': 'D:\\ProteinBackboneDesign\\ProteinBackbone\\pdb_dataset\\debug', 'dataset': 'pdb', 'train_set': 'pdb_dataset_train.pkl', 'val_set': 'pdb_dataset_val.pkl', 'test_set': 'pdb_dataset_test.pkl'}, 'model': {'name': 'pdb_default', 'hidden_dim': 256, 'num_convs': 4, 'sigma_begin': 0.1, 'sigma_end': 0.001, 'num_noise_level': 50, 'order': 3, 'mlp_act': 'relu', 'gnn_act': 'relu', 'cutoff': 10.0, 'short_cut': True, 'concat_hidden': False, 'noise_type': 'symmetry', 'edge_encoder': 'mlp'}}
set seed for random, numpy and torch
loading data from D:\ProteinBackboneDesign\ProteinBackbone\pdb_dataset\debug
train size : 341  ||  val size: 14  ||  test size: 0 
loading data done!
start training...
Epoch: 0 | Step: 1 | loss: 16120231540297593233339075002368.00000 | Lr: 0.00100
Epoch: 0 | Step: 2 | loss: 29276809929424896.00000 | Lr: 0.00100
Epoch: 0 | Step: 3 | loss: 833634735333834752.00000 | Lr: 0.00100
Epoch: 0 | Step: 4 | loss: 96759454195777536.00000 | Lr: 0.00100
Epoch: 0 | Step: 5 | loss: 18523864694784.00000 | Lr: 0.00100
Epoch: 0 | Step: 6 | loss: 368702154719887360.00000 | Lr: 0.00100
Epoch: 0 | Step: 7 | loss: 4101451370463232.00000 | Lr: 0.00100
Epoch: 0 | Step: 8 | loss: 106706778841939968.00000 | Lr: 0.00100
Epoch: 0 | Step: 9 | loss: 23286281886760960.00000 | Lr: 0.00100
Epoch: 0 | Step: 10 | loss: 9516614588301312.00000 | Lr: 0.00100
Epoch: 0 | Train Loss: 732737797286329391697830608896.00000 | Time: 0.92213
Evaluate val Loss: 21785336845697024.00000 | Time: 0.01100
Epoch: 1 | Train Loss: 18352191134787721258321575936.00000 | Time: 0.58310
Evaluate val Loss: 29070490437943296.00000 | Time: 0.01080
Epoch: 2 | Train Loss: 94797718947078177793440219136.00000 | Time: 0.56390
Evaluate val Loss: 7282937925992448.00000 | Time: 0.01000
Epoch: 3 | Train Loss: 16823607469313878633987702784.00000 | Time: 0.55607
Evaluate val Loss: 523119970222080.00000 | Time: 0.00900
Epoch: 4 | Train Loss: 16680504309864867696729915392.00000 | Time: 0.55994
Evaluate val Loss: 442862500052992.00000 | Time: 0.00996
Epoch: 5 | Train Loss: 17527653926287840280632623104.00000 | Time: 0.54520
Evaluate val Loss: 1118561552564224.00000 | Time: 0.00994
Epoch: 6 | Train Loss: 17500878966941592393200173056.00000 | Time: 0.59305
Evaluate val Loss: 368092085485568.00000 | Time: 0.01201
Epoch: 7 | Train Loss: 17615041747358790627427876864.00000 | Time: 0.56714
Evaluate val Loss: 1286372635705344.00000 | Time: 0.01002
Epoch: 8 | Train Loss: 17599907850699363489190772736.00000 | Time: 0.58483
Evaluate val Loss: 1107623210385408.00000 | Time: 0.00951
Epoch: 9 | Train Loss: 17242864317335473147076411392.00000 | Time: 0.61630
Evaluate val Loss: 6593794317221888.00000 | Time: 0.01100
Epoch: 10 | Train Loss: 17592994306168816162551365632.00000 | Time: 0.61900
Evaluate val Loss: 404022171271168.00000 | Time: 0.00900
Epoch: 11 | Train Loss: 17426856301628553046823796736.00000 | Time: 0.52986
Evaluate val Loss: 1017380041916416.00000 | Time: 0.00936
Epoch: 12 | Train Loss: 17548044246148340211131613184.00000 | Time: 0.53476
Evaluate val Loss: 344013357973504.00000 | Time: 0.00987
Epoch: 13 | Train Loss: 17616144205279477159434387456.00000 | Time: 0.55337
Evaluate val Loss: 305560280891392.00000 | Time: 0.01000
Epoch: 14 | Train Loss: 17587631415067981843307429888.00000 | Time: 0.56917
Evaluate val Loss: 355622621020160.00000 | Time: 0.01000
Epoch: 15 | Train Loss: 17579247926642715949357072384.00000 | Time: 0.55527
Evaluate val Loss: 160682662166528.00000 | Time: 0.01000
Epoch: 16 | Train Loss: 15423102968997375388766175232.00000 | Time: 0.55571
Evaluate val Loss: 245523499974656.00000 | Time: 0.01000
Epoch: 17 | Train Loss: 17403362957682174923768856576.00000 | Time: 0.58237
Evaluate val Loss: 209398731374592.00000 | Time: 0.01200
Epoch: 18 | Train Loss: 17366698504309166202236698624.00000 | Time: 0.60744
Evaluate val Loss: 254083973775360.00000 | Time: 0.01484
Epoch: 19 | Train Loss: 17127978585539686055666515968.00000 | Time: 0.55925
Evaluate val Loss: 314186454269952.00000 | Time: 0.01000
Epoch: 20 | Train Loss: 17481877881438457037974405120.00000 | Time: 0.54984
Evaluate val Loss: 314388888158208.00000 | Time: 0.01000
Epoch: 21 | Train Loss: 17533033989629235820134137856.00000 | Time: 0.54141
Evaluate val Loss: 183919408316416.00000 | Time: 0.00883
Epoch: 22 | Train Loss: 16979734056909420162885615616.00000 | Time: 0.54798
Evaluate val Loss: 265549976174592.00000 | Time: 0.01203
Epoch: 23 | Train Loss: 17440343380303483618019246080.00000 | Time: 0.55637
Evaluate val Loss: 113181439557632.00000 | Time: 0.00900
Epoch: 24 | Train Loss: 17022626882367299245129596928.00000 | Time: 0.58853
Evaluate val Loss: 458575906340864.00000 | Time: 0.00988
Epoch: 25 | Train Loss: 17538915482430654602817830912.00000 | Time: 0.56305
Evaluate val Loss: 363775777570816.00000 | Time: 0.00987
Epoch: 26 | Train Loss: 17549026498376548398917484544.00000 | Time: 0.63029
Evaluate val Loss: 495611879096320.00000 | Time: 0.01162
Epoch: 27 | Train Loss: 16935994639933038494545346560.00000 | Time: 0.63312
Evaluate val Loss: 348431604252672.00000 | Time: 0.00991
Epoch: 28 | Train Loss: 17323251015442644253156573184.00000 | Time: 0.54912
Evaluate val Loss: 471018997022720.00000 | Time: 0.00896
Epoch: 29 | Train Loss: 14901796639893006458934001664.00000 | Time: 0.56201
Evaluate val Loss: 94095913517056.00000 | Time: 0.00986
Epoch: 30 | Train Loss: 17516213778829387318207447040.00000 | Time: 0.54123
Evaluate val Loss: 296432535863296.00000 | Time: 0.01000
Epoch: 31 | Train Loss: 17542870249707049376114802688.00000 | Time: 0.56753
Evaluate val Loss: 392701006577664.00000 | Time: 0.01001
Epoch: 32 | Train Loss: 17105314660870272932124819456.00000 | Time: 0.55243
Evaluate val Loss: 183828006043648.00000 | Time: 0.00985
Epoch: 33 | Train Loss: 17384061357948545196410011648.00000 | Time: 0.58668
Evaluate val Loss: 132284975939584.00000 | Time: 0.01104
Epoch: 34 | Train Loss: 17498904159139412998990331904.00000 | Time: 0.58422
Evaluate val Loss: 58781073408000.00000 | Time: 0.00987
Epoch: 35 | Train Loss: 17390174676013674686197006336.00000 | Time: 0.59824
Evaluate val Loss: 141029730680832.00000 | Time: 0.00988
Epoch: 36 | Train Loss: 17214322334312481245823500288.00000 | Time: 0.55124
Evaluate val Loss: 162634775134208.00000 | Time: 0.00995
Epoch: 37 | Train Loss: 17520022582050828042618535936.00000 | Time: 0.54706
Evaluate val Loss: 106877518086144.00000 | Time: 0.01001
Epoch: 38 | Train Loss: 17559070542579614816357318656.00000 | Time: 0.54286
Evaluate val Loss: 505858395996160.00000 | Time: 0.00896
Epoch: 39 | Train Loss: 17542140429432433063313276928.00000 | Time: 0.52914
Evaluate val Loss: 62167604789248.00000 | Time: 0.01000
Epoch: 40 | Train Loss: 17613887772712708483393257472.00000 | Time: 0.56508
Evaluate val Loss: 94672923918336.00000 | Time: 0.01000
Epoch: 41 | Train Loss: 17042302836971208365737771008.00000 | Time: 0.57790
Evaluate val Loss: 444990622793728.00000 | Time: 0.01000
Epoch: 42 | Train Loss: 16731595163536872143623028736.00000 | Time: 0.56811
Evaluate val Loss: 125856617857024.00000 | Time: 0.01000
Epoch: 43 | Train Loss: 17611286178086655621926486016.00000 | Time: 0.59139
Evaluate val Loss: 360013654654976.00000 | Time: 0.01600
Epoch: 44 | Train Loss: 17200993240261540132289511424.00000 | Time: 0.61754
Evaluate val Loss: 55676952903680.00000 | Time: 0.00900
Epoch: 45 | Train Loss: 17480091968295834322131222528.00000 | Time: 0.55838
Evaluate val Loss: 596928513441792.00000 | Time: 0.01000
Epoch: 46 | Train Loss: 17351640165513502361718358016.00000 | Time: 0.55325
Evaluate val Loss: 331555536896000.00000 | Time: 0.01000
Epoch: 47 | Train Loss: 17572497518408488734372659200.00000 | Time: 0.52809
Evaluate val Loss: 483337969860608.00000 | Time: 0.01000
Epoch: 48 | Train Loss: 17398496344368696743155466240.00000 | Time: 0.56713
Evaluate val Loss: 19696172662784.00000 | Time: 0.00900
Epoch: 49 | Train Loss: 17587555857204240535821221888.00000 | Time: 0.54762
Evaluate val Loss: 39990637625344.00000 | Time: 0.01000
Epoch: 50 | Train Loss: 17447861387744216491245961216.00000 | Time: 0.54072
Evaluate val Loss: 168358322372608.00000 | Time: 0.00900
Epoch: 51 | Train Loss: 17610628481227406248987590656.00000 | Time: 0.54475
Evaluate val Loss: 15818183147520.00000 | Time: 0.00996
Epoch: 52 | Train Loss: 17144931022601074698868490240.00000 | Time: 0.61487
Evaluate val Loss: 52119872733184.00000 | Time: 0.01148
Epoch: 53 | Train Loss: 17598154564815954218143711232.00000 | Time: 0.58345
Evaluate val Loss: 74463743836160.00000 | Time: 0.01000
Epoch: 54 | Train Loss: 17614454456690659437888667648.00000 | Time: 0.56427
Evaluate val Loss: 140363935252480.00000 | Time: 0.00900
Epoch: 55 | Train Loss: 17608665693994748247692804096.00000 | Time: 0.59592
Evaluate val Loss: 117158361169920.00000 | Time: 0.00999
Epoch: 56 | Train Loss: 17601791645619846441747873792.00000 | Time: 0.54789
Evaluate val Loss: 113398721282048.00000 | Time: 0.00900
Epoch: 57 | Train Loss: 17587056144969154343380975616.00000 | Time: 0.57232
Evaluate val Loss: 433437395648512.00000 | Time: 0.01000
Epoch: 58 | Train Loss: 17611821952029507747670130688.00000 | Time: 0.56226
Evaluate val Loss: 1334453720842240.00000 | Time: 0.01000
Epoch: 59 | Train Loss: 16751781133721025743914270720.00000 | Time: 0.60463
Evaluate val Loss: 324443138162688.00000 | Time: 0.00997
Epoch: 60 | Train Loss: 16069921213096083902668210176.00000 | Time: 0.56300
Evaluate val Loss: 709586982010880.00000 | Time: 0.01005
Epoch: 61 | Train Loss: 17319146849663116776419885056.00000 | Time: 0.60852
Evaluate val Loss: 157963461328896.00000 | Time: 0.01120
Epoch: 62 | Train Loss: 17511771319888351335152615424.00000 | Time: 0.60261
Evaluate val Loss: 121667841949696.00000 | Time: 0.00959
Epoch: 63 | Train Loss: 17585223866773838304433405952.00000 | Time: 0.54388
Evaluate val Loss: 443340415827968.00000 | Time: 0.01308
Epoch: 64 | Train Loss: 17616230066488225021558784000.00000 | Time: 0.53731
Evaluate val Loss: 509926233341952.00000 | Time: 0.00923
Epoch: 65 | Train Loss: 16530927215274255409209147392.00000 | Time: 0.57527
Evaluate val Loss: 103347147243520.00000 | Time: 0.01004
Epoch: 66 | Train Loss: 16345817318042474469660819456.00000 | Time: 0.57287
Evaluate val Loss: 785581328039936.00000 | Time: 0.00979
Epoch: 67 | Train Loss: 16730465230029298422767419392.00000 | Time: 0.57092
Evaluate val Loss: 199843871981568.00000 | Time: 0.01004
Epoch: 68 | Train Loss: 15830528142449262909550755840.00000 | Time: 0.57655
Evaluate val Loss: 41394861244416.00000 | Time: 0.01094
Epoch: 69 | Train Loss: 16797553744121212184251334656.00000 | Time: 0.68624
Evaluate val Loss: 207986190450688.00000 | Time: 0.01297
Epoch: 70 | Train Loss: 16285316075888078584390090752.00000 | Time: 0.63838
Evaluate val Loss: 51733736718336.00000 | Time: 0.01458
Epoch: 71 | Train Loss: 16635202218888488567009443840.00000 | Time: 0.57480
Evaluate val Loss: 155771585167360.00000 | Time: 0.00985
Epoch: 72 | Train Loss: 16724003315456536768210272256.00000 | Time: 0.56301
Evaluate val Loss: 47065396674560.00000 | Time: 0.00911
Epoch: 73 | Train Loss: 53744936972291145398495477760.00000 | Time: 0.54603
Evaluate val Loss: 93627644641280.00000 | Time: 0.01287
Epoch: 74 | Train Loss: 16650494100172085482814963712.00000 | Time: 0.56949
Evaluate val Loss: 94920379465728.00000 | Time: 0.00987
Epoch: 75 | Train Loss: 16776574416368009051331624960.00000 | Time: 0.58352
Evaluate val Loss: 76391387234304.00000 | Time: 0.01000
Epoch: 76 | Train Loss: 16034491443904818069301624832.00000 | Time: 0.55630
Evaluate val Loss: 94000769925120.00000 | Time: 0.00904
Epoch: 77 | Train Loss: 53767157853123260168269725696.00000 | Time: 0.58299
Evaluate val Loss: 89684940161024.00000 | Time: 0.01192
Epoch: 78 | Train Loss: 16724200796236719303356841984.00000 | Time: 0.60514
Evaluate val Loss: 83340736593920.00000 | Time: 0.01091
Epoch: 79 | Train Loss: 16797110700283872049042030592.00000 | Time: 0.59100
Evaluate val Loss: 107032589893632.00000 | Time: 0.00997
Epoch: 80 | Train Loss: 16632511328605317873841209344.00000 | Time: 0.55540
Evaluate val Loss: 84542597627904.00000 | Time: 0.00893
Epoch: 81 | Train Loss: 16783125626597877542473957376.00000 | Time: 0.53022
Evaluate val Loss: 89432258510848.00000 | Time: 0.00900
Epoch: 82 | Train Loss: 16791296179225331222553034752.00000 | Time: 0.56944
Evaluate val Loss: 87927870717952.00000 | Time: 0.01000
Epoch: 83 | Train Loss: 16800825056175672972734889984.00000 | Time: 0.55400
Evaluate val Loss: 74269295902720.00000 | Time: 0.01000
Epoch: 84 | Train Loss: 16078459251696597649772773376.00000 | Time: 0.56219
Evaluate val Loss: 56117694562304.00000 | Time: 0.01000
Epoch: 85 | Train Loss: 16612060905898229126534266880.00000 | Time: 0.55800
Evaluate val Loss: 66054155927552.00000 | Time: 0.01000
Epoch: 86 | Train Loss: 16605492523426600947460079616.00000 | Time: 0.60172
Evaluate val Loss: 46677448720384.00000 | Time: 0.01000
Epoch: 87 | Train Loss: 15902519331562453770300293120.00000 | Time: 0.60466
Evaluate val Loss: 43873657159680.00000 | Time: 0.01000
Epoch: 88 | Train Loss: 16339327927882838820394106880.00000 | Time: 0.55280
Evaluate val Loss: 61916248539136.00000 | Time: 0.00900
Epoch: 89 | Train Loss: 16788701453496009504147374080.00000 | Time: 0.59268
Evaluate val Loss: 56571266596864.00000 | Time: 0.00889
Epoch: 90 | Train Loss: 16694497969671554030775566336.00000 | Time: 0.57053
Evaluate val Loss: 30956387827712.00000 | Time: 0.00956
Epoch: 91 | Train Loss: 16785778737949154492154904576.00000 | Time: 0.57196
Evaluate val Loss: 47993805864960.00000 | Time: 0.01003
Epoch: 92 | Train Loss: 16562087965164415546046808064.00000 | Time: 0.60665
Evaluate val Loss: 42643140640768.00000 | Time: 0.00940
Epoch: 93 | Train Loss: 16743220771205533249489076224.00000 | Time: 0.59005
Evaluate val Loss: 34708343750656.00000 | Time: 0.00995
Epoch: 94 | Train Loss: 16521776127642464065807187968.00000 | Time: 0.54920
Evaluate val Loss: 47316572569600.00000 | Time: 0.00903
Epoch: 95 | Train Loss: 16803756357843397933088636928.00000 | Time: 0.61410
Evaluate val Loss: 9479415398400.00000 | Time: 0.00987
Epoch: 96 | Train Loss: 16366027329364888003503194112.00000 | Time: 0.58874
Evaluate val Loss: 60639091359744.00000 | Time: 0.00903
Epoch: 97 | Train Loss: 16799758659962627029706211328.00000 | Time: 0.53251
Evaluate val Loss: 67492818976768.00000 | Time: 0.01126
Epoch: 98 | Train Loss: 16767002608813260384738738176.00000 | Time: 0.54895
Evaluate val Loss: 52534651650048.00000 | Time: 0.01000
Epoch: 99 | Train Loss: 16798918937340767625740812288.00000 | Time: 0.56111
Evaluate val Loss: 21381639045120.00000 | Time: 0.01000
optimization finished.
Total time elapsed: 58.59574s
